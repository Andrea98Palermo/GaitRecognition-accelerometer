import matplotlib.pyplot as plt
from scipy.ndimage.filters import gaussian_filter1d


#FAR = [1.00000000e+00, 3.03873340e-02, 1.92831216e-02, 1.45429363e-02, 1.27758143e-02, 1.06863120e-02, 9.11023020e-03, 7.55802846e-03, 6.85356768e-03, 6.34014710e-03, 6.02970675e-03, 5.09838571e-03, 4.68048524e-03, 4.33422485e-03, 4.01184449e-03, 3.83274429e-03, 3.64170408e-03, 3.47454389e-03, 3.28350368e-03, 3.04470341e-03, 2.78202312e-03, 1.98204222e-03, 1.82682205e-03, 1.59996179e-03, 1.52832171e-03, 1.40892158e-03, 1.28952144e-03, 1.14624128e-03, 1.11042124e-03, 1.02684115e-03, 9.31321043e-04, 8.59680963e-04, 8.11920909e-04, 7.64160856e-04, 7.04460789e-04, 6.56700736e-04, 6.32820709e-04, 5.85060655e-04, 5.49240615e-04, 5.13420575e-04, 4.41780495e-04, 4.05960455e-04, 3.82080428e-04, 3.58200401e-04, 3.22380361e-04, 3.10440348e-04, 3.10440348e-04, 3.10440348e-04, 3.10440348e-04, 2.74620308e-04, 2.50740281e-04, 2.38800267e-04, 2.26860254e-04, 2.02980227e-04, 1.91040214e-04, 1.91040214e-04, 1.91040214e-04, 1.79100201e-04, 1.67160187e-04, 1.67160187e-04, 1.55220174e-04, 1.55220174e-04, 1.55220174e-04, 1.43280160e-04, 1.43280160e-04, 1.43280160e-04, 1.43280160e-04, 1.43280160e-04, 1.43280160e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.19400134e-04, 1.07460120e-04, 7.16400802e-05, 3.58200401e-05, 2.38800267e-05, 2.38800267e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00]

#FRR = [0.0, 0.06715064, 0.07622505, 0.07985481, 0.08892922, 0.09437387, 0.09618875, 0.10163339, 0.10163339, 0.10526316, 0.11252269, 0.11615245, 0.12341198, 0.13248639, 0.13974592, 0.14337568, 0.14882033, 0.15245009, 0.15607985, 0.15970962, 0.16515426, 0.17604356, 0.17604356, 0.17785844, 0.1814882, 0.1923775, 0.19963702, 0.20508167, 0.2123412, 0.21597096, 0.22504537, 0.23411978, 0.24682396, 0.25589837, 0.25771325, 0.25771325, 0.26860254, 0.27586207, 0.27767695, 0.28130672, 0.28675136, 0.29582577, 0.30671506, 0.31578947, 0.323049, 0.323049, 0.32667877, 0.33393829, 0.33756806, 0.34119782, 0.35027223, 0.36297641, 0.36660617, 0.37931034, 0.38294011, 0.38475499, 0.39564428, 0.41016334, 0.41560799, 0.42831216, 0.43920145, 0.44283122, 0.44646098, 0.45916515, 0.47368421, 0.48638838, 0.49183303, 0.50090744, 0.50998185, 0.51905626, 0.53176044, 0.54446461, 0.5553539, 0.56442831, 0.5753176, 0.58076225, 0.59891107, 0.61161525, 0.62068966, 0.6261343, 0.64065336, 0.66969147, 0.676951, 0.69509982, 0.70417423, 0.72413793, 0.74228675, 0.76043557, 0.76406534, 0.77132486, 0.78039927, 0.81488203, 0.82395644, 0.83303085, 0.84754991, 0.84936479, 0.85480944, 0.86025408, 0.86932849, 0.88021779, 0.90744102]

FAR = [1.00000000e+00, 1.26205941e-02, 8.27442927e-03, 6.19686694e-03,
 5.34912599e-03, 4.63272519e-03, 4.09542459e-03, 3.55812399e-03,
 3.18798357e-03, 2.87754322e-03, 2.62680294e-03, 2.17308243e-03,
 2.01786226e-03, 1.86264209e-03, 1.67160187e-03, 1.50444168e-03,
 1.43280160e-03, 1.42086159e-03, 1.34922151e-03, 1.26564142e-03,
 1.15818130e-03, 7.40280829e-04, 5.97000669e-04, 5.13420575e-04,
 4.77600535e-04, 4.29840481e-04, 3.94020441e-04, 3.58200401e-04,
 3.58200401e-04, 3.58200401e-04, 3.22380361e-04, 2.86560321e-04,
 2.74620308e-04, 2.62680294e-04, 2.50740281e-04, 2.38800267e-04,
 2.02980227e-04, 2.02980227e-04, 1.67160187e-04, 1.43280160e-04,
 1.43280160e-04, 1.19400134e-04, 1.19400134e-04, 9.55201070e-05,
 8.35800936e-05, 8.35800936e-05, 8.35800936e-05, 5.97000669e-05,
 4.77600535e-05, 4.77600535e-05, 4.77600535e-05, 4.77600535e-05,
 4.77600535e-05, 4.77600535e-05, 4.77600535e-05, 3.58200401e-05,
 3.58200401e-05, 3.58200401e-05, 3.58200401e-05, 3.58200401e-05,
 3.58200401e-05, 3.58200401e-05, 3.58200401e-05, 3.58200401e-05,
 3.58200401e-05, 3.58200401e-05, 3.58200401e-05, 3.58200401e-05,
 3.58200401e-05, 3.58200401e-05, 3.58200401e-05, 3.58200401e-05,
 3.58200401e-05, 2.38800267e-05, 1.19400134e-05, 1.19400134e-05,
 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05,
 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05,
 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05,
 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05,
 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05,
 1.19400134e-05, 1.19400134e-05, 1.19400134e-05, 1.19400134e-05,
 1.19400134e-05]

FRR = [0.0, 0.01633394, 0.01633394, 0.02177858, 0.02177858, 0.02359347,
 0.02540835, 0.02722323, 0.02903811, 0.03085299, 0.03266788, 0.03448276,
 0.03629764, 0.03811252, 0.04174229, 0.04174229, 0.04174229, 0.04174229,
 0.04174229, 0.04355717, 0.04537205, 0.0508167,  0.05989111, 0.06170599,
 0.06533575, 0.06896552, 0.06896552, 0.07259528, 0.07259528, 0.07441016,
 0.07803993, 0.08348457, 0.08529946, 0.08529946, 0.08892922, 0.0907441,
 0.0907441,  0.09800363, 0.09981851, 0.10707804, 0.11252269, 0.11978221,
 0.11978221, 0.11978221, 0.12341198, 0.12885662, 0.13067151, 0.14519056,
 0.14882033, 0.15245009, 0.15970962, 0.1615245,  0.16696915, 0.16878403,
 0.17059891, 0.17604356, 0.1814882,  0.18874773, 0.1923775,  0.20145191,
 0.20689655, 0.21960073, 0.22504537, 0.23049002, 0.23774955, 0.24137931,
 0.24863884, 0.2522686,  0.26134301, 0.26678766, 0.27767695, 0.28675136,
 0.29219601, 0.29945554, 0.30671506, 0.323049,   0.33575318, 0.35571688,
 0.3738657,  0.37931034, 0.38656987, 0.41197822, 0.42649728, 0.43375681,
 0.44283122, 0.44827586, 0.45372051, 0.46823956, 0.47731397, 0.48638838,
 0.51179673, 0.54627949, 0.56079855, 0.58257713, 0.59891107, 0.62431942,
 0.65154265, 0.67150635, 0.71506352, 0.74228675, 0.78402904]



smooth_FRR = gaussian_filter1d(FRR, sigma=5)

plt.plot(FAR, label="FAR", color="#fc03e8", linewidth=1)
plt.plot(smooth_FRR, label="FRR", linewidth=1, markevery=[1, 21, 42], marker="o")
plt.margins(0.01)
plt.xlabel("soglia in centesimi")
plt.ylabel("error rate")

plt.vlines(21, 0, 0.0508167, linestyles="dashed", colors=["#000000"])
plt.hlines(0.0508167, 0, 21, linestyles="dashed", colors=["#000000"])
plt.vlines(42, 0, 0.11978221, linestyles="dashed", colors=["#000000"])
plt.hlines(0.11978221, 0, 42, linestyles="dashed", colors=["#000000"])
plt.legend()
plt.annotate("ZeroFar(FAR = 0.001)", (21, 0.0508167))
plt.annotate("ZeroFar(FAR = 0.0001)", (42, 0.11978221))
plt.annotate("EER", (0, 0.02447726621453816))
plt.show()
