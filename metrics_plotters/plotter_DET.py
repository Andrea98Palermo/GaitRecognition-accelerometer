import matplotlib.pyplot as plt
from scipy.interpolate import interp1d
import numpy as np
from statsmodels.nonparametric.kernel_regression import KernelReg
from scipy.ndimage.filters import gaussian_filter1d

FARs = [1.26205941e-02, 8.27442927e-03, 6.19686694e-03,
 5.34912599e-03, 4.63272519e-03, 4.09542459e-03, 3.55812399e-03,
 3.18798357e-03, 2.87754322e-03, 2.62680294e-03, 2.17308243e-03,
 2.01786226e-03, 1.86264209e-03, 1.67160187e-03, 1.50444168e-03,
 1.43280160e-03, 1.42086159e-03, 1.34922151e-03, 1.26564142e-03,
 1.15818130e-03, 7.40280829e-04, 5.97000669e-04, 5.13420575e-04,
 4.77600535e-04, 4.29840481e-04, 3.94020441e-04, 3.58200401e-04,
 3.58200400e-04, 3.58200399e-04, 3.22380361e-04, 2.86560321e-04,
 2.74620308e-04, 2.62680294e-04, 2.50740281e-04, 2.38800267e-04,
 2.02980227e-04, 2.02980226e-04, 1.67160187e-04, 1.43280160e-04,
 1.43280159e-04, 1.19400134e-04, 1.19400133e-04, 9.55201070e-05,
 8.35800936e-05, 8.35800935e-05, 8.35800934e-05, 5.97000669e-05,
 4.77600535e-05, 4.77600534e-05, 4.77600533e-05, 4.77600532e-05,
 4.77600531e-05, 4.77600530e-05, 4.77600529e-05, 3.58200401e-05,
 3.58200400e-05, 3.58200399e-05, 3.58200398e-05, 3.58200397e-05,
 3.58200396e-05, 3.58200395e-05, 3.58200394e-05, 3.58200393e-05,
 3.58200392e-05, 3.58200391e-05, 3.58200390e-05, 3.58200389e-05,
 3.58200388e-05, 3.58200387e-05, 3.58200386e-05, 3.58200385e-05,
 3.58200384e-05, 2.38800267e-05, 1.19400134e-05, 1.19400133e-05,
 1.19400132e-05, 1.19400131e-05, 1.19400130e-05, 1.19400129e-05,
 1.19400128e-05, 1.19400127e-05, 1.19400126e-05, 1.19400125e-05,
 1.19400124e-05, 1.19400123e-05, 1.19400122e-05, 1.19400121e-05,
 1.19400120e-05, 1.19400119e-05, 1.19400118e-05, 1.19400117e-05,
 1.19400116e-05, 1.19400115e-05, 1.19400114e-05, 1.19400113e-05,
 1.19400112e-05, 1.19400111e-05, 1.19400110e-05, 1.19400109e-05,
 1.19400108e-05]


FRRs =  [0.01633394, 0.01633394, 0.02177858, 0.02177858, 0.02359347,
 0.02540835, 0.02722323, 0.02903811, 0.03085299, 0.03266788, 0.03448276,
 0.03629764, 0.03811252, 0.04174229, 0.04174229, 0.04174229, 0.04174229,
 0.04174229, 0.04355717, 0.04537205, 0.0508167,  0.05989111, 0.06170599,
 0.06533575, 0.06896552, 0.06896552, 0.07259528, 0.07259528, 0.07441016,
 0.07803993, 0.08348457, 0.08529946, 0.08529946, 0.08892922, 0.0907441,
 0.0907441,  0.09800363, 0.09981851, 0.10707804, 0.11252269, 0.11978221,
 0.11978221, 0.11978221, 0.12341198, 0.12885662, 0.13067151, 0.14519056,
 0.14882033, 0.15245009, 0.15970962, 0.1615245,  0.16696915, 0.16878403,
 0.17059891, 0.17604356, 0.1814882,  0.18874773, 0.1923775,  0.20145191,
 0.20689655, 0.21960073, 0.22504537, 0.23049002, 0.23774955, 0.24137931,
 0.24863884, 0.2522686,  0.26134301, 0.26678766, 0.27767695, 0.28675136,
 0.29219601, 0.29945554, 0.30671506, 0.323049,   0.33575318, 0.35571688,
 0.3738657,  0.37931034, 0.38656987, 0.41197822, 0.42649728, 0.43375681,
 0.44283122, 0.44827586, 0.45372051, 0.46823956, 0.47731397, 0.48638838,
 0.51179673, 0.54627949, 0.56079855, 0.58257713, 0.59891107, 0.62431942,
 0.65154265, 0.67150635, 0.71506352, 0.74228675, 0.78402904]

#FARs.reverse()
#FRRs.reverse()


xnew = np.linspace(1.19400108e-05, 1.26205941e-02, 1080)
#xnew = np.logspace(-4, -3, 100)
spl = interp1d(FARs, FRRs, kind='linear')
DET_smooth = spl(xnew) 

"""
kr = KernelReg(FRRs, FARs, 'c', bw=[0.11])
y_pred, y_std = kr.fit(FARs)
"""
#smooth_FRR = gaussian_filter1d(y_pred, sigma=1)
#plt.xlim(right=0.9)
plt.loglog(FARs, FRRs, 'o', label="DET(coordinate precise)", color='#dde004', linewidth=10)
plt.loglog(xnew, DET_smooth, '-', label='DET(linea interpolata)', linewidth=3)
#plt.xscale('log')
#plt.yscale('log')
plt.yticks([10e-2, 10e-1, 1])
plt.xlabel("FAR")
plt.ylabel("FRR")
plt.legend()
plt.show()

